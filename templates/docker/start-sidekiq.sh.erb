#!/bin/bash

bundle check || bundle install
bundle config git.allow_insecure true

echo 'Stopping sidekiq if exists'
bundle exec sidekiqctl stop tmp/pids/sidekiq.pid

echo 'Stopped sidekiq'
rm -rf ./tmp/pids/sidekiq.pid

echo 'Starting sidekiq'
bundle exec sidekiq -C config/sidekiq.yml

echo 'Started sidekiq'